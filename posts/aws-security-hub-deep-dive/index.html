<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="AWS Security Hub: Deep dive" /><meta property="og:locale" content="en" /><meta name="description" content="AWS Security Hub is one of the most important security services on AWS. This post contains everything you need to know about the service." /><meta property="og:description" content="AWS Security Hub is one of the most important security services on AWS. This post contains everything you need to know about the service." /><link rel="canonical" href="https://www.playingaws.com//posts/aws-security-hub-deep-dive/" /><meta property="og:url" content="https://www.playingaws.com//posts/aws-security-hub-deep-dive/" /><meta property="og:site_name" content="Playing AWS" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-17T23:20:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="AWS Security Hub: Deep dive" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-05-29T00:04:03+02:00","datePublished":"2022-06-17T23:20:00+02:00","description":"AWS Security Hub is one of the most important security services on AWS. This post contains everything you need to know about the service.","headline":"AWS Security Hub: Deep dive","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.playingaws.com//posts/aws-security-hub-deep-dive/"},"url":"https://www.playingaws.com//posts/aws-security-hub-deep-dive/"}</script><title>AWS Security Hub: Deep dive | Playing AWS</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Playing AWS"><meta name="application-name" content="Playing AWS"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/favicons/favicon.ico" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Playing AWS</a></div><div class="site-subtitle font-italic">Learn, remove barriers and practice</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://www.linkedin.com/in/alejandro-lazaro-chueca/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://github.com/alazaroc" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>AWS Security Hub: Deep dive</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"> <img src="/assets/img/header.jpeg" alt="header"><h1 data-toc-skip>AWS Security Hub: Deep dive</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1655500800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 17, 2022 </em> </span> <span> Updated <em class="" data-ts="1685311443" data-df="ll" data-toggle="tooltip" data-placement="bottom"> May 29, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://www.linkedin.com/in/alejandro-lazaro-chueca/">Alejandro Lazaro</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1734 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><hr /><h2 id="introduction"><span class="mr-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>AWS Security Hub is a cloud security posture management service that:</p><ul><li>Reduced effort to collect and prioritize findings<li>performs <strong>automatic security checks</strong> against best practices and standards<li><strong>aggregates your security alerts</strong> in a consolidated view of findings across accounts and providers<li><strong>enables automated remediation</strong></ul><p>Security Hub enables you to understand your overall security posture via a <strong>consolidated security score</strong> across all of your AWS accounts, and automatically assesses the security of your AWS accounts resources via the security standards available:</p><ul><li>AWS Foundational Security Best Practices<li>CIS AWS Foundations Benchmark<li>PCI DSS</ul><blockquote class="prompt-tip"><div><p>Enabling this service is a MUST and a quick win to improve your security posture: just by enabling some security standard you will receive security alerts (findings), and the service will aggregate your security alerts automatically.</p></div></blockquote><blockquote class="prompt-warning"><div><p>Before you can enable Security Hub standards and controls, you must first enable resource recording in AWS Config. You must enable resource recording for all of the accounts and in all of the Regions where you plan to enable Security Hub standards and controls,</p></div></blockquote><h3 id="how-it-works"><span class="mr-2">How it works</span><a href="#how-it-works" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>To maintain a <strong>complete view</strong> of your security posture on AWS, you need to <strong>integrate multiple tools and services</strong> including</p><ul><li>Threat detections from <kbd>Amazon GuardDuty</kbd>,<li>vulnerabilities scan from <kbd>Amazon Inspector</kbd>,<li>publicly accessible and cross-account resources from <kbd>IAM Access Analyzer</kbd>,<li>sensitive data classifications from <kbd>Amazon Macie</kbd>,<li>resources lacking WAF coverage from <kbd>AWS Firewall Manager</kbd>,<li>resource configuration issues from <kbd>AWS Config</kbd>,<li>and <kbd>AWS Partner Network Products</kbd>.</ul><p><a href="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-Hub_How-it-works.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-Hub_How-it-works.png" alt="how-it-works" class="lazyload" data-proofer-ignore></a></p><p><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-get-started.html" target="_blank">More information</a></p><h3 id="getting-started"><span class="mr-2">Getting started</span><a href="#getting-started" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Whether an account needs to enable AWS Security Hub manually depends on how the accounts are managed.</p><h4 id="multi-account-environment"><span class="mr-2">Multi-account environment</span><a href="#multi-account-environment" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>If you use the integration with <kbd>AWS Organizations</kbd>:</p><ul><li>The organization management account chooses a Security Hub administrator account. Security Hub is enabled automatically for the chosen account. See Designating a Security Hub <strong>administrator account</strong>.<li>The Security Hub administrator account enables organization accounts as <strong>member accounts</strong>. Those organization accounts also have Security Hub enabled automatically. See Managing member accounts that belong to an organization.<li>The only organization account for which Security Hub is not enabled automatically is the <strong>organization management account</strong>. The organization management account does not need to enable Security Hub before it designates the Security Hub administrator account. The organization management account must enable Security Hub before it is enabled as a member account.</ul><h4 id="standalone-account-environment"><span class="mr-2">Standalone account environment</span><a href="#standalone-account-environment" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><blockquote class="prompt-info"><div><p>Accounts that are not managed using the Organizations integration must enable Security Hub <strong>manually</strong>.</p></div></blockquote><p>To start using AWS Security Hub, it only takes a few clicks from the Management Console to start adding findings and performing security checks.</p><p><a href="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-1.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-1.png" alt="security-hub-1" class="lazyload" data-proofer-ignore></a></p><p>As you can see in the image, you only need to check the Security Standard you want to enable and then enable de service. Additionally, you can download a CloudFormation template to deploy it as StackSet.</p><p><a href="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-2.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-2.png" alt="security-hub-2" class="lazyload" data-proofer-ignore></a></p><blockquote class="prompt-info"><div><p>After you enable a security standard, AWS Security Hub begins to run all checks within two hours but it can take up to 24 hours for the Security standards pane to populate</p></div></blockquote><hr /><h3 id="estimating-costs"><span class="mr-2">Estimating costs</span><a href="#estimating-costs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Pricing (USD), Per account, per month, per Region</p><div class="table-wrapper"><table><thead><tr><th>Security checks<th> <tbody><tr><td>First 100,000<td>$0.0010/check<tr><td>100,001 – 500,000<td>$0.0008/check<tr><td>500,001 +<td>$0.0005/check</table></div><div class="table-wrapper"><table><thead><tr><th>Finding ingestion events<th> <tbody><tr><td>First 10,000<td>Free<tr><td>10,001 +<td>$0.00003/finding</table></div><p>It includes ingestion of updates to existing findings. Finding ingestions for Security Hub security checks is free.</p><p>Within the Security Hub service, under the <kbd>Settings Usage tab</kbd>, you can find your monthly estimate:</p><p><a href="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-cost-estimation.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-cost-estimation.png" alt="cost-estimation" class="lazyload" data-proofer-ignore></a></p><hr /><h2 id="hands-on-with-aws-security-hub"><span class="mr-2">Hands-on with AWS Security Hub</span><a href="#hands-on-with-aws-security-hub" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="summary"><span class="mr-2">Summary</span><a href="#summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>On the Summary page:</p><ul><li>Security standards show you your security score (total and by standard), and the resources with the most failed security checks<li>Findings by Region summarize the number of active findings for each severity across Regions. The counts only include findings that have a workflow status of NEW or NOTIFIED.<li>Insights: An AWS Security Hub insight is a collection of related findings. It identifies a security area that requires attention and intervention.</ul><p><a href="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-3.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-3.png" alt="security-hub-3" class="lazyload" data-proofer-ignore></a></p><h3 id="security-standards"><span class="mr-2">Security Standards</span><a href="#security-standards" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This page shows you the 3 security standards and whether you have them enabled (with their security score) or not (you can enable them with a one-click action).</p><p>If you access one of them, you will be able to see more details about how many security controls are enabled, failed, passed, disabled… and a table with information about compliance status, severity, ID, title and Failed checks:</p><p><a href="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-security-standard-1.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-security-standard-1.png" alt="security-standard-1" class="lazyload" data-proofer-ignore></a></p><h3 id="findings"><span class="mr-2">Findings</span><a href="#findings" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This page shows all the findings, the ones generated by AWS Security Hub with Security Standards and all the rest of the other tools and services.</p><p>In the following image, you can view Security Hub and GuardDuty findings:</p><p><a href="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-findings.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-findings.png" alt="findings" class="lazyload" data-proofer-ignore></a></p><h3 id="finding-aggregation-cross-account--cross-region"><span class="mr-2">Finding aggregation (cross-account &amp; cross-region)</span><a href="#finding-aggregation-cross-account--cross-region" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>With finding aggregation, you can use a single aggregation account &amp; Region to view and update findings from multiple linked accounts &amp; Regions. Administrator accounts configure the aggregation. Security Hub replicates <code class="language-plaintext highlighter-rouge">findings</code> and finds updates for all of the member accounts in the linked Regions.</p><ul><li>You can <strong>connect multiple AWS accounts</strong> and consolidate findings across those accounts <a href="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-accounts-aggregation.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-accounts-aggregation.png" alt="accounts-aggregation" class="lazyload" data-proofer-ignore></a><li>You can also <strong>designate an aggregator Region</strong> and link some or all Regions to that aggregator Region to give you a centralized view of all your findings across all your accounts and all your linked Regions <a href="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-region-aggregation.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-region-aggregation.png" alt="region-aggregation" class="lazyload" data-proofer-ignore></a></ul><p>Interesting article in AWS Security Blog: <a href="https://aws.amazon.com/blogs/security/best-practices-for-cross-region-aggregation-of-security-findings/" target="_blank">Best practices for cross-Region aggregation of security findings</a>. Best practices mentioned:</p><ul><li>Enable cross-Region aggregation<li>Consolidating downstream SIEM and ticketing integrations<li>Auto-archive GuardDuty findings associated with global resources<li>Reduce AWS Config cost by recording global resources in one Region<li>Disable AWS Security Hub AWS Foundational Best Practices periodic controls associated with global resources<li>Implement automatic remediation from a central Region</ul><p>You also can show your AWS Security Hub findings in a view of data to enable decision-makers to assess the health and status of an organization’s IT infrastructure at a glance. This article contains <a href="https://aws.amazon.com/blogs/security/how-to-build-a-multi-region-aws-security-hub-analytic-pipeline/" target="_blank">how to do it</a>.</p><h3 id="disable-controls"><span class="mr-2">Disable controls</span><a href="#disable-controls" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote class="prompt-info"><div><p>When you enable a standard, all the controls for that standard are enabled by default. You can then disable and enable specific controls within an enabled standard.</p></div></blockquote><p>There are several reasons why you may choose to disable the controls:</p><ul><li>Controls for unused services<li>Controls using global resources<li>Controls with compensating controls</ul><p>It can be useful to turn off security checks for controls that are not relevant to your environment. Disabling irrelevant controls reduces the number of irrelevant findings. It also removes the failed check from the security score for the associated standard.</p><p>When you disable a control, the following occurs:</p><ul><li>The check for the control is no longer performed.<li>No additional findings are generated for that control.<li>Existing findings are archived automatically after three to five days (note that this is the best effort and not guaranteed).<li>The related AWS Config rules that Security Hub created are removed.</ul><blockquote class="prompt-warning"><div><p>Remember that Security Hub is Regional. When you disable or enable a control, it is disabled only in the current Region or in the Region that you specify in the API request.</p></div></blockquote><p>This is the fastest way to disable one control, with the CLI:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">aws securityhub update-standards-control --standards-control-arn "arn:aws:securityhub:eu-west-1:1234567890:control/aws-foundational-security-best-practices/v/1.0.0/GuardDuty.1" --control-status "DISABLED" --disabled-reason "testing functionality"
</span></pre></table></code></div></div><p>With the AWS Console, you can easily disable a control. Access to a security standard:</p><p><a href="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-disable-control-1.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-disable-control-1.png" alt="security-hub-disable-control-1" class="lazyload" data-proofer-ignore></a></p><p>And then:</p><p><a href="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-disable-control-2.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/security-hub-disable-control-2.png" alt="security-hub-disable-control-2" class="lazyload" data-proofer-ignore></a></p><p>In the following links, you will find more information on how to do it in depth, how to do it in a multi-account environment (several options), and more relevant information!</p><ul><li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-enable-disable-controls.html" target="_blank">How to disable controls</a><li><a href="https://aws.amazon.com/blogs/security/disabling-security-hub-controls-in-a-multi-account-environment/" target="_blank">How to disable in a multi-account environment</a><li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-to-disable.html" target="_blank">AWS Foundational Best Practices controls that you might want to disable</a><li><a href="https://github.com/aws-samples/aws-security-hub-automatic-suppression-rules" target="_blank">how to Create Auto-Suppression Rules in AWS Security Hub</a></ul><h3 id="integrations"><span class="mr-2">Integrations</span><a href="#integrations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Security Hub provides the ability to integrate security findings from AWS services and third-party products.</p><blockquote class="prompt-info"><div><p>For AWS services Security Hub automatically enables the integration, and you can optionally disable each integration. For third-party products Security Hub gives you the ability to selectively enable the integrations and provides a link to the configuration instructions related to the third-party product.</p></div></blockquote><p>Some examples of custom integrations:</p><ul><li><a href="https://aws.amazon.com/blogs/security/how-to-set-up-a-two-way-integration-between-aws-security-hub-and-jira-service-management/" target="_blank">Integrate with Jira Service Management</a><ul><li><a href="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/integration-jira.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/integration-jira.png" alt="jira" class="lazyload" data-proofer-ignore></a></ul><li><a href="https://github.com/aws-samples/aws-securityhub-to-slack" target="_blank">Integrate with Slack</a><ul><li><a href="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/integration-slack.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/integration-slack.png" alt="slack" class="lazyload" data-proofer-ignore></a></ul><li><a href="https://github.com/aws-samples/aws-security-hub-summary-email" target="_blank">Summary email</a></ul><h3 id="automated-response-remediation-and-enrichment-actions"><span class="mr-2">Automated response, remediation, and enrichment actions</span><a href="#automated-response-remediation-and-enrichment-actions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>You can create custom automated response, remediation, and enrichment workflows using Security Hub’s integration with Amazon EventBridge. All Security Hub findings are automatically sent to EventBridge, and you can create EventBridge rules that have AWS Lambda functions, AWS Step Function functions, or AWS Systems Manager Automation runbooks as their targets.</p><p>Security Hub also supports <a href="https://aws.amazon.$$com/blogs/apn/how-to-enable-custom-actions-in-aws-security-hub/" target="_blank">sending findings to EventBridge on-demand via custom actions</a>, so that you can have an analyst decide when to trigger an automated response or remediation action.</p><p>The Security Hub <a href="https://aws.amazon.com/solutions/implementations/aws-security-hub-automated-response-and-remediation/?did=sl_card&amp;trk=sl_card" target="_blank">Automated Response and Remediation (SHARR) solution</a> provides you with pre-packaged EventBridge rules for you to deploy via AWS CloudFormation.</p><p><a href="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/sharr.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-04-aws-security-hub-deep-dive/sharr.png" alt="Sharr" class="lazyload" data-proofer-ignore></a></p><p>More info about automated response and remediation <a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cloudwatch-events.html" target="_blank">here</a></p><hr /><h2 id="good-to-know"><span class="mr-2">Good to know</span><a href="#good-to-know" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Regional service. You must enable it in all the regions you want to review.<li><strong>30 days free trial</strong> when you enable it the first time, and during the free trial Security Hub provides an estimate of what the spend would be, so you can assess your spending beyond the free trial.<li>All findings are stored in Security Hub for <strong>90 days</strong> after the last update date<li><strong>Periodic checks run automatically within 12 hours</strong> after the most recent run. You cannot change the periodicity.<li><strong>Change-triggered checks run when the associated resource changes state</strong>. Even if the resource does not change state, the updated time for change-triggered checks is refreshed <strong>every 18 hours</strong>.<li>After control statuses are generated for the first time, Security Hub <strong>updates the control status every 24 hours</strong> based on the findings from the previous 24 hours<li>Security Hub processes the findings using a standard findings format called the <strong>AWS Security Finding Format</strong> (ASFF), which eliminates the need for time-consuming data conversion efforts. With the ASFF, <strong>all of Security Hub’s integration partners</strong> (including both AWS services and external partners) <strong>send their findings to Security Hub in a well-typed JSON format</strong> consisting of over 1,000 available fields. This means that all of your security findings are normalized before they are ingested into Security Hub, and you don’t need to do any parsing and normalization yourself. The findings identify resources, severities, and timestamps consistently so that you can more easily search and take action on them.<li>The events are delivered to EventBridge in near-real-time and on a guaranteed basis<li>When you enabled a security standard, AWS Config rules are created automatically (and you cannot delete them)<li>You can create Custom Findings with AWS Config Rules and send them to Security Hub with EventBridge</ul><hr /><h2 id="more-information-about-security-hub"><span class="mr-2">More information about Security Hub</span><a href="#more-information-about-security-hub" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/what-is-securityhub.html" target="_blank">AWS official documentation</a><li><a href="https://catalog.us-east-1.prod.workshops.aws/workshops/adccbda9-ceaf-47a8-843b-cf231281b635/en-US/#overview" target="_blank">Security Hub Workshop</a><li><a href="https://aws.amazon.com/blogs/security/automatically-resolve-security-hub-findings-for-resources-that-no-longer-exist/" target="_blank">Automatically resolve findings for resources that no longer exist</a><li><a href="https://aws.amazon.com/blogs/security/how-to-enrich-aws-security-hub-findings-with-account-metadata/" target="_blank">Enrich findings with account metadata</a><li><a href="https://aws.amazon.com/blogs/security/correlate-security-findings-with-aws-security-hub-and-amazon-eventbridge/" target="_blank">Correlate findings</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/security/'>Security</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/security/" class="post-tag no-text-decoration" >security</a> <a href="/tags/security-hub/" class="post-tag no-text-decoration" >security hub</a> <a href="/tags/deep-dive/" class="post-tag no-text-decoration" >deep dive</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=AWS%20Security%20Hub:%20Deep%20dive%20-%20Playing%20AWS&url=https%3A%2F%2Fwww.playingaws.com%2F%2Fposts%2Faws-security-hub-deep-dive%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fwww.playingaws.com%2F%2Fposts%2Faws-security-hub-deep-dive%2F&text=AWS%20Security%20Hub:%20Deep%20dive%20-%20Playing%20AWS" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fwww.playingaws.com%2F%2Fposts%2Faws-security-hub-deep-dive%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading"></div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/aws-open-source-tools/">Getting started with AWS open-source tools</a><li><a href="/posts/getting-started-with-aws-security/">Getting Started with AWS Security</a><li><a href="/posts/how-to-improve-your-account-security/">How to improve your account security</a></ul></div><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/challenge-data-certification-in-30-days/">Challenge: 'AWS Certified Data Analytics Specialty' in 30 days</a><li><a href="/posts/10-steps-to-prepare-any-aws-certification/">10 steps to prepare any AWS certification</a><li><a href="/posts/aws-control-tower-deep-dive/">AWS Control Tower Deep Dive</a><li><a href="/posts/the-technology-behind-this-blog/">How I decided on the technology behind the blog</a><li><a href="/posts/multi-account-approach/">Getting started with AWS Multi-account approach</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/github/">github</a> <a class="post-tag" href="/tags/how-to/">how-to</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/iac/">iac</a> <a class="post-tag" href="/tags/getting-started/">getting-started</a> <a class="post-tag" href="/tags/cdk/">cdk</a> <a class="post-tag" href="/tags/deep-dive/">deep dive</a> <a class="post-tag" href="/tags/serverless/">serverless</a> <a class="post-tag" href="/tags/certification/">certification</a> <a class="post-tag" href="/tags/open-source/">open-source</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/aws-waf-web-application-firewall-deep-dive/"><div class="card-body"> <em class="small" data-ts="1684518060" data-df="ll" > May 19, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS WAF (Web Application Firewall): Deep Dive</h3><div class="text-muted small"><p> Introduction A Web Application Firewall (WAF) is a security solution that protects web applications from malicious attacks, such as cross-site scripting, SQL injection, and malicious bot traffic. ...</p></div></div></a></div><div class="card"> <a href="/posts/amazon-guardduty-deep-dive/"><div class="card-body"> <em class="small" data-ts="1655645400" data-df="ll" > Jun 19, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Amazon GuardDuty: Deep dive</h3><div class="text-muted small"><p> Introduction Amazon GuardDuty is a continuous security monitoring service that analyzes and processes the following data sources: AWS CloudTrail management event logs, AWS CloudTrail data ...</p></div></div></a></div><div class="card"> <a href="/posts/aws-control-tower-deep-dive/"><div class="card-body"> <em class="small" data-ts="1665268200" data-df="ll" > Oct 9, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS Control Tower Deep Dive</h3><div class="text-muted small"><p> Introduction This is the second article of AWS Control Tower and the AWS multi-account approach. In the first article I had explained why you need a multi-account approach, what are the best ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/how-to-improve-your-account-security/" class="btn btn-outline-primary" prompt="Older"><p>How to improve your account security</p></a> <a href="/posts/amazon-guardduty-deep-dive/" class="btn btn-outline-primary" prompt="Newer"><p>Amazon GuardDuty: Deep dive</p></a></div><script type="text/javascript"> document.getElementsByClassName("post-content")[0].innerHTML += '<h2 id="comment-this-post">Comment this post</h2>'; document.getElementsByClassName("post-content")[0].innerHTML += '<p>I hope this content has been relevant to you. To help me improve it would be helpful if you could give me your honest feedback.</p>'; $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "alazaroc/blog-web", "data-repo-id": "R_kgDOHA-hqQ", "data-category": "Announcements", "data-category-id": "DIC_kwDOHA-hqc4CT2E5", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "top", "data-lang": "", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementsByClassName("post-content")[0].appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/github/">github</a> <a class="post-tag" href="/tags/how-to/">how-to</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/iac/">iac</a> <a class="post-tag" href="/tags/getting-started/">getting-started</a> <a class="post-tag" href="/tags/cdk/">cdk</a> <a class="post-tag" href="/tags/deep-dive/">deep dive</a> <a class="post-tag" href="/tags/serverless/">serverless</a> <a class="post-tag" href="/tags/certification/">certification</a> <a class="post-tag" href="/tags/open-source/">open-source</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://www.linkedin.com/in/alejandro-lazaro-chueca/">Alejandro Lazaro</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Deployed with AWS resources.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-HW1NDPDLBF"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-HW1NDPDLBF'); }); </script>
