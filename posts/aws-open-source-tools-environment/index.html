<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Open source tools to analyze your AWS environment" /><meta property="og:locale" content="en" /><meta name="description" content="This article is the second part of a series on open source tools, focusing on tools for inventory, analysis and security assessment of the AWS environment." /><meta property="og:description" content="This article is the second part of a series on open source tools, focusing on tools for inventory, analysis and security assessment of the AWS environment." /><link rel="canonical" href="https://www.playingaws.com//posts/aws-open-source-tools-environment/" /><meta property="og:url" content="https://www.playingaws.com//posts/aws-open-source-tools-environment/" /><meta property="og:site_name" content="Playing AWS" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-01-30T18:02:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Open source tools to analyze your AWS environment" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-02-11T16:04:31+01:00","datePublished":"2023-01-30T18:02:00+01:00","description":"This article is the second part of a series on open source tools, focusing on tools for inventory, analysis and security assessment of the AWS environment.","headline":"Open source tools to analyze your AWS environment","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.playingaws.com//posts/aws-open-source-tools-environment/"},"url":"https://www.playingaws.com//posts/aws-open-source-tools-environment/"}</script><title>Open source tools to analyze your AWS environment | Playing AWS</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Playing AWS"><meta name="application-name" content="Playing AWS"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/favicons/favicon.ico" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Playing AWS</a></div><div class="site-subtitle font-italic">Learn, remove barriers and practice</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://www.linkedin.com/in/alejandro-lazaro-chueca/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://github.com/alazaroc" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Open source tools to analyze your AWS environment</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"> <img src="/assets/img/header.jpeg" alt="header"><h1 data-toc-skip>Open source tools to analyze your AWS environment</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1675098120" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 30, 2023 </em> </span> <span> Updated <em class="" data-ts="1676127871" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 11, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://www.linkedin.com/in/alejandro-lazaro-chueca/">Alejandro Lazaro</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1698 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><hr /><h2 id="introduction"><span class="mr-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This is the second part of the series <code class="language-plaintext highlighter-rouge">Open source tools</code>. If this is the first article of this series that you are reading, I recommend you to review the first one <code class="language-plaintext highlighter-rouge">Getting started with AWS open-source tools</code> <a href="/posts/aws-open-source-tools/" target="_blank">here</a></p><blockquote class="prompt-warning"><div><p>Some open source tool could appear in several categories (in this same article or among the 3 open source tools articles). I thought it was better not to mix information between categories when a tool could be part of several of them.</p></div></blockquote><h2 id="inventory-and-analyze-your-environment"><span class="mr-2">Inventory and analyze your environment</span><a href="#inventory-and-analyze-your-environment" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>These open source tools are useful to analyze all your AWS environment:</p><ul><li>General<ul><li><kbd>cloudmapper</kbd>: <code class="language-plaintext highlighter-rouge">Analyze</code> your AWS environment<li><kbd>prowler</kbd>: <code class="language-plaintext highlighter-rouge">Quick analysis</code> of your AWS environment</ul><li>IAM (specific)<ul><li><kbd>AirIAM</kbd>: Detect <code class="language-plaintext highlighter-rouge">IAM unused resources</code>: users, access keys, roles, groups, policies and policy attachments</ul></ul><h3 id="cloudmapper"><span class="mr-2">cloudmapper</span><a href="#cloudmapper" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>CloudMapper helps you analyze your Amazon Web Services (AWS) environments.</p><p>Based on Python components.</p><blockquote class="prompt-info"><div><p><strong>Why use it</strong>: Analyze your AWS environment: review status of the account, resource inventory (all resources in all the regions and region usage), IAM resources (active/inactive), public resources (ec2, elb, elbv2, rds, redshift, ecs, autoscaling, cloudfront and apigateway) and finally findings of security (a few).</p><p>List of the commands of this tool: <a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudmapper-commands.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudmapper-commands.png" alt="cloudmapper-commands" class="lazyload" data-proofer-ignore></a></p><p>The shortcut is:</p><ol><li><p>Run the <code class="language-plaintext highlighter-rouge">collect</code> command to get your resources (you can filter the regions that you want using the <code class="language-plaintext highlighter-rouge">--regions 'eu-west-1,eu-west-2'</code>… us-east-1 will be always added)</p><li><p>Then run the <code class="language-plaintext highlighter-rouge">report</code> command (an html page will be generated with all the information)</p></ol><p><a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudmapper-report-1.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudmapper-report-1.png" alt="cloudmapper-report-1" class="lazyload" data-proofer-ignore></a> <a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudmapper-report-2.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudmapper-report-2.png" alt="cloudmapper-report-2" class="lazyload" data-proofer-ignore></a> <a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudmapper-report-3.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudmapper-report-3.png" alt="cloudmapper-report-3" class="lazyload" data-proofer-ignore></a></p><p>A specific command that I like is the <code class="language-plaintext highlighter-rouge">iam_report</code> because it allows you review unused permissions in your IAM resources:</p><p><a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudmapper-iam_report.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudmapper-iam_report.png" alt="cloudmapper-iam_report" class="lazyload" data-proofer-ignore></a></p></div></blockquote><p><strong>Is it popular?</strong>: On github: Watch 135; Fork 759; Stars 5.3K</p><p><strong>Recently updated?</strong> No. The last commit was on Jul 25, 2022 (956 commits). Also, some original functionality of this tools is now deprecated (generation of networking diagrams).</p><p><strong>URL</strong>: <a href="https://github.com/duo-labs/cloudmapper" target="_blank">https://github.com/duo-labs/cloudmapper</a></p><blockquote class="prompt-tip"><div><p>There is a CDK project to run in Fargate service the CloudMapper’s collection and audit capabilities nightly, across multiple accounts, sending any audit findings to a Slack channel and keeping a copy of the collected metadata in an S3 bucket. This is the diagram of the solution <a href="https://github.com/duo-labs/cloudmapper/blob/main/auditor/README.md" target="_blank">https://github.com/duo-labs/cloudmapper/blob/main/auditor/README.md</a></p></div></blockquote><h3 id="prowler"><span class="mr-2">prowler</span><a href="#prowler" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Prowler is an Open Source security tool… and you will find all this information in the following section (this is for inventory and analysis of the environment).</p><p>prowler has a functionality to perform a quick inventory check. It will give you in the console information about the number of each resource that you have, and in json/csv generated files you will find information about what is the specific resource (region, aws service, resource type, resource id and ARN)</p><blockquote class="prompt-info"><div><p><strong>Why use it</strong>: Perform a quick analysis of your AWS environment (a few seconds).</p><p><a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/prowler-inventory-1.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/prowler-inventory-1.png" alt="prowler-inventory-1" class="lazyload" data-proofer-ignore></a> <a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/prowler-inventory-2.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/prowler-inventory-2.png" alt="prowler-inventory-2" class="lazyload" data-proofer-ignore></a></p><p>And this is the CSV file report:</p><p><a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/prowler-inventory-csv.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/prowler-inventory-csv.png" alt="prowler-inventory-csv" class="lazyload" data-proofer-ignore></a></p></div></blockquote><p><strong>Is it popular?</strong>: On github: Watch 122; Fork 1.1k; Stars 7.6K</p><p><strong>Recently updated?</strong> Last commit yesterday (in the time I am writing this post). Total commits 2271</p><p><strong>URL</strong>: <a href="https://github.com/prowler-cloud/prowler" target="_blank">https://github.com/prowler-cloud/prowler</a></p><h3 id="airiam"><span class="mr-2">AirIAM</span><a href="#airiam" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>AirIAM scans existing IAM usage patterns and provides a simple method to migrate IAM configurations into a right-sized Terraform plan. It <code class="language-plaintext highlighter-rouge">identifies unused users, roles, groups, policies and policy attachments</code> and replaces them with a Least Privileges Terraform code modelled to manage AWS IAM.</p><p>AirIAM was created to promote immutable and version-controlled IAM management to replace today’s manual and error prone methods.</p><blockquote class="prompt-info"><div><p><strong>Why use it</strong>: IAM scan tool to detect unused resources (based on Amazon Access Advisor APIs) and the creation of terraform templates of your IAM resources.</p><p><a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/airiam.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/airiam.png" alt="airiam-image" class="lazyload" data-proofer-ignore></a></p><p>This is another example analyzing other AWS account and exporting the results in a txt file:</p><p><a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/airmiam-file.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/airmiam-file.png" alt="airmiam-file" class="lazyload" data-proofer-ignore></a></p></div></blockquote><p><strong>Is it popular?</strong>: On github: Watch 15; Fork 68; Stars 673</p><p><strong>Recently updated?</strong> No. Last commit the Aug 2, 2022. In total, 426 commits</p><p><strong>URL</strong>: <a href="https://github.com/bridgecrewio/AirIAM" target="_blank">https://github.com/bridgecrewio/AirIAM</a></p><p><strong>Updated</strong>:</p><blockquote class="prompt-warning"><div><p>First time I used this tool the terraform template generation functionality works fine, now now I receive an error and I was not able to use it. However, I think that this tool is useful to find this iam unused resources</p></div></blockquote><h3 id="summary-which-tool-should-i-use-to-analyze-my-environment"><span class="mr-2">Summary: Which tool should I use to analyze my environment?</span><a href="#summary-which-tool-should-i-use-to-analyze-my-environment" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote class="prompt-warning"><div><p>This is my personal opinion. If you have a different one, let me know in the comments at the end of this article!</p></div></blockquote><p>It depends what you want to do:</p><ul><li>Full analysis of the AWS environment: <code class="language-plaintext highlighter-rouge">cloudmapper</code><li>Get a quick inventory of the AWS environment: <code class="language-plaintext highlighter-rouge">prowler</code><li>Fast IAM unused resources analysis: <code class="language-plaintext highlighter-rouge">AirIAM</code><li>Apply least-privilege to IAM roles (review which permissions you are not using): <code class="language-plaintext highlighter-rouge">cloudmapper</code></ul><h2 id="security-assessment"><span class="mr-2">Security Assessment</span><a href="#security-assessment" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There are many different tools to realize a security assessment of your environment.</p><ul><li>General<ul><li><kbd>prowler</kbd>: <code class="language-plaintext highlighter-rouge">security best practices assessments</code>, audits, incident response, continuous monitoring, hardening and forensics readiness<li><kbd>Scoutsuite</kbd>: multi-cloud <code class="language-plaintext highlighter-rouge">security-auditing tool</code>, which enables security posture assessment of cloud environments<li><kbd>cloudsploit</kbd>: Cloud Security Scans to detect <code class="language-plaintext highlighter-rouge">potential misconfigurations and security risks</code><li><kbd>steampipe</kbd> yes, AGAIN. Ensure that cloud resources comply with security benchmarks such as CIS, NIST, and SOC2.</ul><li>IAM<ul><li><kbd>cloudsplaining</kbd>: <code class="language-plaintext highlighter-rouge">IAM Security Assessment tool</code></ul></ul><h3 id="prowler-1"><span class="mr-2">prowler</span><a href="#prowler-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This is the second time I mention prowler in this article in two different categories.</p><p>Prowler is an Open Source security tool to perform AWS and Azure <code class="language-plaintext highlighter-rouge">security best practices assessments, audits, incident response, continuous monitoring, hardening and forensics readiness</code>.</p><p>It contains <code class="language-plaintext highlighter-rouge">more than 240 controls</code> covering CIS, PCI-DSS, ISO27001, GDPR, HIPAA, FFIEC, SOC2, AWS FTR, ENS and custom security frameworks.</p><p>There are 4 available categories:</p><ul><li>secrets<li>trust-boundaries<li>internet-exposed<li>forensics-ready</ul><p>There are 3 available Compliance Frameworks:</p><ul><li>cis_1.4_aws<li>cis_1.5_aws<li>ens_rd2022_aws</ul><p>severity:</p><ul><li>informational<li>low<li>medium<li>high<li>critical</ul><blockquote class="prompt-info"><div><p><strong>Why use it</strong>: Security tool to perform security best practices assessments, audits, incident response, continuous monitoring, hardening and forensics readiness.</p><p>By default, prowler will scan all AWS regions. If you want analyze only a few regions you can use the following command <code class="language-plaintext highlighter-rouge">-f us-east-1 eu-west-1 ...</code></p><p><a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/prowler-1.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/prowler-1.png" alt="prowler-1" class="lazyload" data-proofer-ignore></a> <a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/prowler-2.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/prowler-2.png" alt="prowler-2" class="lazyload" data-proofer-ignore></a></p><p>And this is the HTML file report:</p><p><a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/prowler-report-1.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/prowler-report-1.png" alt="prowler-report-1" class="lazyload" data-proofer-ignore></a> <a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/prowler-report-2.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/prowler-report-2.png" alt="prowler-report-2" class="lazyload" data-proofer-ignore></a></p></div></blockquote><p><strong>Is it popular?</strong>: On github: Watch 122; Fork 1.1k; Stars 7.6K</p><p><strong>Recently updated?</strong> Last commit yesterday (in the time I am writing this post). Total commits 2271</p><p><strong>URL</strong>: <a href="https://github.com/prowler-cloud/prowler" target="_blank">https://github.com/prowler-cloud/prowler</a></p><h3 id="scoutsuite"><span class="mr-2">Scoutsuite</span><a href="#scoutsuite" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Scout Suite is an open source <code class="language-plaintext highlighter-rouge">multi-cloud security-auditing tool</code>, which enables security posture assessment of cloud environments. Using the APIs exposed by cloud providers, Scout Suite gathers configuration data for manual inspection and highlights risk areas. Rather than going through dozens of pages on the web consoles, Scout Suite presents a clear view of the attack surface automatically.</p><p>Scout Suite was designed by security consultants/auditors. It is meant to provide a point-in-time security-oriented view of the cloud account it was run in. Once the data has been gathered, all usage may be performed offline.</p><blockquote class="prompt-info"><div><p><strong>Why use it</strong>: Enable security posture assessment of cloud environments.</p><p>By default, scoutsuite will scan all AWS regions. If you want analyze only a few regions you can use the following command <code class="language-plaintext highlighter-rouge">-r us-east-1 eu-west-1 ...</code></p><p><a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/scoutsuite-1.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/scoutsuite-1.png" alt="scoutsuite-1" class="lazyload" data-proofer-ignore></a> <a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/scoutsuite-2.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/scoutsuite-2.png" alt="scoutsuite-2" class="lazyload" data-proofer-ignore></a></p></div></blockquote><p><strong>Is it popular?</strong>: On github: Watch 113; Fork 816; Stars 5K</p><p><strong>Recently updated?</strong>: No. Last commit was on Sep 5, 2022 (6101 commits in total)</p><p><strong>URL</strong>: <a href="https://github.com/nccgroup/ScoutSuite" target="_blank">https://github.com/nccgroup/ScoutSuite</a></p><blockquote class="prompt-warning"><div><p>I didn’t found information about what security frameworks is using or more information about the security controls. However, the findings in the audit report are useful and you have to review them!</p></div></blockquote><h3 id="cloudsploit"><span class="mr-2">cloudsploit</span><a href="#cloudsploit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>CloudSploit by Aqua is an open-source project designed to allow detection of security risks in cloud infrastructure accounts, including: Amazon Web Services (AWS), Microsoft Azure, Google Cloud Platform (GCP), Oracle Cloud Infrastructure (OCI), and GitHub. These scripts are designed to return a series of <code class="language-plaintext highlighter-rouge">potential misconfigurations and security risks</code>.</p><p>Compliance:</p><ul><li>hipaa<li>PCI<li>CIS (level 1 and 2)</ul><blockquote class="prompt-info"><div><p><strong>Why use it</strong>: detect potential misconfigurations and security risks in your AWS account</p><p><a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudsploit-1.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudsploit-1.png" alt="cloudsploit-1" class="lazyload" data-proofer-ignore></a></p><p>However, in the console the result is not clear:</p><p><a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudsploit-2.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudsploit-2.png" alt="cloudsploit-2" class="lazyload" data-proofer-ignore></a></p><p>A better solution is generate the report in a csv file adding the following command <code class="language-plaintext highlighter-rouge">--csv=file.csv</code>. After convert the csv into a table it will look like this:</p><p><a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudsploit-3.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudsploit-3.png" alt="cloudsploit-3" class="lazyload" data-proofer-ignore></a></p></div></blockquote><p><strong>Is it popular?</strong>: On github: Watch 70; Fork 575; Stars 2.5k</p><p><strong>Recently updated?</strong>: Yes. Last commit was 3 weeks ago (3449 commits in total)</p><p><strong>URL</strong>: <a href="https://github.com/aquasecurity/cloudsploit" target="_blank">https://github.com/aquasecurity/cloudsploit</a></p><blockquote class="prompt-tip"><div><p>I didn’t found how to scan only a few regions. In the official documentation only is included how to suppress all one region results <code class="language-plaintext highlighter-rouge">./index.js --suppress *:us-east-1:*</code>. And to exclude more than one region you can use something like this <code class="language-plaintext highlighter-rouge">--suppress "*:ap-*-*:*" --suppress "*:af-*-*:*" ...</code></p></div></blockquote><h3 id="steampipe"><span class="mr-2">steampipe</span><a href="#steampipe" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>I mention this tool in my first article about open source, when I talked about <code class="language-plaintext highlighter-rouge">Extend CLI</code> capabilities <a href="/posts/aws-open-source-tools/#steampipe" target="_blank">here</a></p><p>Steampipe is the universal interface to APIs, and we can use SQL to query cloud infrastructure, SaaS, code, logs, and more.</p><p>Besides, I am going to show you two new capabilities:</p><ul><li><strong>Check</strong>: <code class="language-plaintext highlighter-rouge">Ensure that cloud resources comply with security benchmarks</code> such as CIS, NIST, and SOC2.<ul><li>AWS security best practices contains 180 controls<li>CIS v1.50 contains 63 controls</ul><li><strong>Visualize</strong>: View <code class="language-plaintext highlighter-rouge">prebuilt dashboards</code> or build your own.</ul><blockquote class="prompt-info"><div><p><strong>Why use it</strong>: for me, the benchmark of AWS security best practices with 180 controls and the CIS level 1.5 with 63 are enough to consider use this tool to perform a security analysis.</p><p><a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/steampipe-2.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/steampipe-2.png" alt="steampipe-2" class="lazyload" data-proofer-ignore></a> <a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/steampipe-3.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/steampipe-3.png" alt="steampipe-3" class="lazyload" data-proofer-ignore></a> <a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/steampipe-4.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/steampipe-4.png" alt="steampipe-4" class="lazyload" data-proofer-ignore></a></p></div></blockquote><p><strong>Is it popular?</strong>: On github: Watch 32; Fork 171; Stars 4.6k</p><p><strong>Recently updated?</strong> Yes, last commit 2 days ago. Total commits 2007</p><p><strong>URL</strong>: <a href="https://github.com/turbot/steampipe" target="_blank">https://github.com/turbot/steampipe</a></p><p>More information (checks and dashboard):</p><ul><li><a href="https://steampipe.io/docs/check/overview" target="_blank">https://steampipe.io/docs/check/overview</a><li><a href="https://steampipe.io/docs/dashboard/overview" target="_blank">https://steampipe.io/docs/dashboard/overview</a><li><a href="https://aws.amazon.com/blogs/opensource/compliance-auditing-with-steampipe-and-sql/" target="_blank">https://aws.amazon.com/blogs/opensource/compliance-auditing-with-steampipe-and-sql/</a></ul><h3 id="cloudsplaining"><span class="mr-2">cloudsplaining</span><a href="#cloudsplaining" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Cloudsplaining is an AWS <code class="language-plaintext highlighter-rouge">IAM Security Assessment tool</code> that identifies violations of least privilege and generates a risk-prioritized HTML report.</p><p>The assessment identifies where resource ARN constraints are not used and identifies other risks in IAM policies:</p><ul><li>Privilege Escalation<li>Resource Exposure<li>Infrastructure Modificationº<li>Data Exfiltration</ul><p>CloudMapper helps you analyze your Amazon Web Services (AWS) environments (using python)</p><blockquote class="prompt-info"><div><p><strong>Why use it</strong>: The tool provides you a report with some risk in IAM policies (customer/inline/AWS) and the IAM principals (IAM Users, Groups, and Roles).</p><p><a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudsplaining-1.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudsplaining-1.png" alt="cloudsplaining-1" class="lazyload" data-proofer-ignore></a> <a href="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudsplaining-2.png" class="popup img-link border"><img data-src="/assets/img/posts/2023-01-30-aws-open-source-tools-environment/cloudsplaining-2.png" alt="cloudsplaining-2" class="lazyload" data-proofer-ignore></a></p></div></blockquote><p><strong>Is it popular?</strong>: On github: Watch 29; Fork 143; Stars 1.6K</p><p><strong>Recently updated?</strong> Yes. Last commit 3 days ago (347 commits in total)</p><p><strong>URL</strong>: <a href="https://github.com/salesforce/cloudsplaining" target="_blank">https://github.com/salesforce/cloudsplaining</a></p><h3 id="summary-which-tool-should-i-use-to-perform-security-assessments-on-my-account"><span class="mr-2">Summary: Which tool should I use to perform security assessments on my account?</span><a href="#summary-which-tool-should-i-use-to-perform-security-assessments-on-my-account" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote class="prompt-warning"><div><p>This is my personal opinion. If you have a different one, let me know in the comments at the end of this article!</p></div></blockquote><ul><li>General security assessment: <code class="language-plaintext highlighter-rouge">prowler</code> or <code class="language-plaintext highlighter-rouge">steampipe</code><li>Security assessment based on CIS 1.5: <code class="language-plaintext highlighter-rouge">steampipe</code>, prowler or cloudsploit<li>Richer tool security assessment based on frameworks: <code class="language-plaintext highlighter-rouge">steampipe</code><li>IAM specific security assessment: <code class="language-plaintext highlighter-rouge">cloudsplaining</code></ul><h2 id="next-steps"><span class="mr-2">Next steps</span><a href="#next-steps" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The next article related with open source tools will be:</p><ul><li><strong>How to help you with your code</strong>: to generate it (IaC), validate it (policy as code and compliance) and analyze it (static analysis/credentials) - <a href="/posts/aws-open-source-tools-code/" target="_blank">here</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/general/'>General</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/open-source/" class="post-tag no-text-decoration" >open-source</a> <a href="/tags/github/" class="post-tag no-text-decoration" >github</a> <a href="/tags/security/" class="post-tag no-text-decoration" >security</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Open%20source%20tools%20to%20analyze%20your%20AWS%20environment%20-%20Playing%20AWS&url=https%3A%2F%2Fwww.playingaws.com%2F%2Fposts%2Faws-open-source-tools-environment%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fwww.playingaws.com%2F%2Fposts%2Faws-open-source-tools-environment%2F&text=Open%20source%20tools%20to%20analyze%20your%20AWS%20environment%20-%20Playing%20AWS" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fwww.playingaws.com%2F%2Fposts%2Faws-open-source-tools-environment%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading"></div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/aws-open-source-tools/">Getting started with AWS open-source tools</a><li><a href="/posts/getting-started-with-aws-security/">Getting Started with AWS Security</a><li><a href="/posts/how-to-improve-your-account-security/">How to improve your account security</a></ul></div><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/challenge-data-certification-in-30-days/">Challenge: 'AWS Certified Data Analytics Specialty' in 30 days</a><li><a href="/posts/10-steps-to-prepare-any-aws-certification/">10 steps to prepare any AWS certification</a><li><a href="/posts/aws-control-tower-deep-dive/">AWS Control Tower Deep Dive</a><li><a href="/posts/the-technology-behind-this-blog/">How I decided on the technology behind the blog</a><li><a href="/posts/multi-account-approach/">Getting started with AWS Multi-account approach</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/github/">github</a> <a class="post-tag" href="/tags/how-to/">how-to</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/iac/">iac</a> <a class="post-tag" href="/tags/getting-started/">getting-started</a> <a class="post-tag" href="/tags/cdk/">cdk</a> <a class="post-tag" href="/tags/deep-dive/">deep dive</a> <a class="post-tag" href="/tags/serverless/">serverless</a> <a class="post-tag" href="/tags/certification/">certification</a> <a class="post-tag" href="/tags/open-source/">open-source</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/aws-open-source-tools-code/"><div class="card-body"> <em class="small" data-ts="1676126460" data-df="ll" > Feb 11, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How open source tools can help you with your code</h3><div class="text-muted small"><p> Introduction This is the last article of a series of 3 about open source tools and AWS. If you haven’t read them I recommend you to do it. Getting started with AWS open-source tools: here ...</p></div></div></a></div><div class="card"> <a href="/posts/aws-open-source-tools/"><div class="card-body"> <em class="small" data-ts="1674587700" data-df="ll" > Jan 24, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Getting started with AWS open-source tools</h3><div class="text-muted small"><p> Introduction This is the first part of a series of articles about open source software and AWS, in which I will share those tools that I have tested and that I think you may find useful. The co...</p></div></div></a></div><div class="card"> <a href="/posts/how-to-deploy-serverless-website-with-terraform/"><div class="card-body"> <em class="small" data-ts="1683312780" data-df="ll" > May 5, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How to deploy a serverless website with Terraform</h3><div class="text-muted small"><p> Introduction As you already know, creating and managing infrastructure can be a complex and time-consuming process, and fortunately, tools like Terraform can simplify this process by allowing yo...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/aws-open-source-tools/" class="btn btn-outline-primary" prompt="Older"><p>Getting started with AWS open-source tools</p></a> <a href="/posts/aws-open-source-tools-code/" class="btn btn-outline-primary" prompt="Newer"><p>How open source tools can help you with your code</p></a></div><script type="text/javascript"> document.getElementsByClassName("post-content")[0].innerHTML += '<h2 id="comment-this-post">Comment this post</h2>'; document.getElementsByClassName("post-content")[0].innerHTML += '<p>I hope this content has been relevant to you. To help me improve it would be helpful if you could give me your honest feedback.</p>'; $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "alazaroc/blog-web", "data-repo-id": "R_kgDOHA-hqQ", "data-category": "Announcements", "data-category-id": "DIC_kwDOHA-hqc4CT2E5", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "top", "data-lang": "", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementsByClassName("post-content")[0].appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/github/">github</a> <a class="post-tag" href="/tags/how-to/">how-to</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/iac/">iac</a> <a class="post-tag" href="/tags/getting-started/">getting-started</a> <a class="post-tag" href="/tags/cdk/">cdk</a> <a class="post-tag" href="/tags/deep-dive/">deep dive</a> <a class="post-tag" href="/tags/serverless/">serverless</a> <a class="post-tag" href="/tags/certification/">certification</a> <a class="post-tag" href="/tags/open-source/">open-source</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://www.linkedin.com/in/alejandro-lazaro-chueca/">Alejandro Lazaro</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Deployed with AWS resources.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-HW1NDPDLBF"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-HW1NDPDLBF'); }); </script>
