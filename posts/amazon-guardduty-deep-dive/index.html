<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Amazon GuardDuty: Deep dive" /><meta property="og:locale" content="en" /><meta name="description" content="Amazon GuardDuty is one of the most important security services on AWS. This post contains everything you need to know about the service." /><meta property="og:description" content="Amazon GuardDuty is one of the most important security services on AWS. This post contains everything you need to know about the service." /><link rel="canonical" href="https://www.playingaws.com//posts/amazon-guardduty-deep-dive/" /><meta property="og:url" content="https://www.playingaws.com//posts/amazon-guardduty-deep-dive/" /><meta property="og:site_name" content="Playing AWS" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-19T15:30:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Amazon GuardDuty: Deep dive" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-02-16T00:51:19+01:00","datePublished":"2022-06-19T15:30:00+02:00","description":"Amazon GuardDuty is one of the most important security services on AWS. This post contains everything you need to know about the service.","headline":"Amazon GuardDuty: Deep dive","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.playingaws.com//posts/amazon-guardduty-deep-dive/"},"url":"https://www.playingaws.com//posts/amazon-guardduty-deep-dive/"}</script><title>Amazon GuardDuty: Deep dive | Playing AWS</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Playing AWS"><meta name="application-name" content="Playing AWS"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/favicons/favicon.ico" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Playing AWS</a></div><div class="site-subtitle font-italic">Learn, remove barriers and practice</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://www.linkedin.com/in/alejandro-lazaro-chueca/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://github.com/alazaroc" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Amazon GuardDuty: Deep dive</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"> <img src="/assets/img/header.jpeg" alt="header"><h1 data-toc-skip>Amazon GuardDuty: Deep dive</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1655645400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 19, 2022 </em> </span> <span> Updated <em class="" data-ts="1676505079" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 16, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://www.linkedin.com/in/alejandro-lazaro-chueca/">Alejandro Lazaro</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1311 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><hr /><h2 id="introduction"><span class="mr-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Amazon GuardDuty is a <strong>continuous security monitoring service</strong> that analyzes and processes the following data sources:</p><ul><li>AWS CloudTrail management event logs,<li>AWS CloudTrail data events for S3,<li>DNS logs,<li>EKS audit logs,<li>and VPC flow logs.</ul><p>It uses <strong>threat intelligence</strong> feeds, such as lists of malicious IP addresses and domains, and machine learning to identify unexpected and potentially unauthorized and malicious activity within your AWS environment.</p><blockquote class="prompt-tip"><div><p>Enabling this service is a MUST and a quick win to improve your security posture. With one-click Amazon GuardDuty reduces risk using intelligent and continuous threat detection of your AWS accounts, data, and workloads.</p></div></blockquote><h3 id="getting-started"><span class="mr-2">Getting started</span><a href="#getting-started" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote class="prompt-info"><div><p>GuardDuty is a Regional service, meaning any of the configuration procedures you follow must be repeated in each region that you want to monitor with GuardDuty. <strong>AWS highly recommend that you enable GuardDuty in all supported AWS Regions</strong>. This enables GuardDuty to generate findings about unauthorized or unusual activity even in Regions that you are not actively using.</p></div></blockquote><p>The first step to using GuardDuty is to enable it in your account. Once enabled, GuardDuty will immediately begin to monitor for security threats in the current region.</p><h3 id="multi-account-environment"><span class="mr-2">Multi-account environment</span><a href="#multi-account-environment" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>When you use GuardDuty with <kbd>AWS Organizations</kbd>, you can designate any account within the organization to be the GuardDuty delegated administrator. Only the organization management account can designate GuardDuty delegated administrators.</p><p>An account that is designated as a delegated administrator becomes a GuardDuty administrator account has GuardDuty automatically enabled in the designated Region and is granted permission to enable and manage GuardDuty for all accounts in the organization within that Region.</p><p><a href="https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_organizations.html" target="_blank">More information</a></p><h3 id="standalone-account-environment"><span class="mr-2">Standalone account environment</span><a href="#standalone-account-environment" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Enable GuardDuty is a one-click action:</p><p><a href="/assets/img/posts/2022-06-18-amazon-guardduty-deep-dive/guardduty-enable-service.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-18-amazon-guardduty-deep-dive/guardduty-enable-service.png" alt="enable-guardduty" class="lazyload" data-proofer-ignore></a></p><h3 id="estimating-costs"><span class="mr-2">Estimating costs</span><a href="#estimating-costs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Pricing (USD), Per account, per month, per Region</p><div class="table-wrapper"><table><thead><tr><th>AWS CloudTrail Management Event Analysis<th> <tbody><tr><td>Per one million events / month<td>$4.00 per one million events</table></div><div class="table-wrapper"><table><thead><tr><th>AWS CloudTrail S3 Data Event Analysis<th> <tbody><tr><td>First 500 million events / month<td>$0.80 per one million events<tr><td>Next 4,500 million events / month<td>$0.40 per one million events<tr><td>Over 5,500 million events / month<td>$0.20 per one million events</table></div><div class="table-wrapper"><table><thead><tr><th>Amazon EKS Audit Logs<th> <tbody><tr><td>There is no data in the official page<td>There is no data in the official page</table></div><div class="table-wrapper"><table><thead><tr><th>VPC Flow Log and DNS Query Log Analysis<th> <tbody><tr><td>First 500 GB / month<td>$1.00 per GB<tr><td>Next 2,000 GB / month<td>$0.50 per GB<tr><td>Next 7,500 GB / month<td>$0.25 per GB<tr><td>Over 10,000 GB / month<td>$0.15 per GB</table></div><p>You can use the GuardDuty console and API operations to estimate how much GuardDuty will cost you. During the 30-day free trial period, the cost estimation projects what your estimated costs will be after the free trial period.</p><p><a href="/assets/img/posts/2022-06-18-amazon-guardduty-deep-dive/guardduty-usage.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-18-amazon-guardduty-deep-dive/guardduty-usage.png" alt="cost-estimation" class="lazyload" data-proofer-ignore></a></p><p><a href="https://aws.amazon.com/guardduty/pricing/" target="_blank">More information</a></p><hr /><h2 id="hands-on-with-amazon-guardduty"><span class="mr-2">Hands-on with Amazon GuardDuty</span><a href="#hands-on-with-amazon-guardduty" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="sample-findings"><span class="mr-2">Sample findings</span><a href="#sample-findings" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>GuardDuty supports generating sample findings with placeholder values, which can be used <strong>to test GuardDuty functionality</strong> and familiarize yourself with findings before needing to respond to a real security issue discovered by GuardDuty.</p><p><a href="/assets/img/posts/2022-06-18-amazon-guardduty-deep-dive/guardduty-sample-findings-1.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-18-amazon-guardduty-deep-dive/guardduty-sample-findings-1.png" alt="enable-guardduty-sample-findings" class="lazyload" data-proofer-ignore></a></p><p>These are the generated GuardDuty findings:</p><p><a href="/assets/img/posts/2022-06-18-amazon-guardduty-deep-dive/guardduty-sample-findings-2.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-18-amazon-guardduty-deep-dive/guardduty-sample-findings-2.png" alt="guardduty-findings" class="lazyload" data-proofer-ignore></a></p><h3 id="filtering-findings"><span class="mr-2">Filtering findings</span><a href="#filtering-findings" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We can filter the results by many criteria using the filter bar or we can filter using the colored buttons in the upper right section.</p><p><a href="/assets/img/posts/2022-06-18-amazon-guardduty-deep-dive/guardduty-filter.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-18-amazon-guardduty-deep-dive/guardduty-filter.png" alt="guardduty-filter" class="lazyload" data-proofer-ignore></a></p><p>You could also save your custom filters and using later.</p><h3 id="suppression-rules"><span class="mr-2">Suppression rules</span><a href="#suppression-rules" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If you are receiving findings for expected behavior in your environment, you can <strong>automatically archive findings</strong> based on criteria you define with suppression rules. Suppression rules are rules which automatically send matched findings to <code class="language-plaintext highlighter-rouge">archive</code>.</p><p><a href="/assets/img/posts/2022-06-18-amazon-guardduty-deep-dive/guardduty-suppression-filter.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-18-amazon-guardduty-deep-dive/guardduty-suppression-filter.png" alt="guardduty-suppression-filter" class="lazyload" data-proofer-ignore></a></p><p>There are some cases where it is desirable to use suppression rules, to facilitate the recognition of security threats with the greatest impact on your environment:</p><ul><li>low-value findings<li>false-positive findings<li>threats you do not intend to act on</ul><blockquote class="prompt-warning"><div><p><strong>Suppressed findings are not sent</strong> to AWS Security Hub, Amazon S3, Detective, or CloudWatch, reducing finding noise level if you consume GuardDuty findings via Security Hub, a third-party SIEM, or other alerting and ticketing applications.</p></div></blockquote><p><a href="https://docs.aws.amazon.com/guardduty/latest/ug/findings_suppression-rule.html" target="_blank">More information about suppression rules</a></p><h3 id="finding-information"><span class="mr-2">Finding information</span><a href="#finding-information" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Select a finding from the table to view its details. In the finding details pane you can see all the information associated with the finding:</p><p><a href="/assets/img/posts/2022-06-18-amazon-guardduty-deep-dive/guardduty-finding-information.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-18-amazon-guardduty-deep-dive/guardduty-finding-information.png" alt="guardduty-finding-information" class="lazyload" data-proofer-ignore></a></p><p>It contains the information related to the finding: overview section, resource affected, action, actor and additional information.</p><p>Amazon GuardDuty integrates with Amazon Detective and if you click on the <code class="language-plaintext highlighter-rouge">Investigate with Detective</code> link you can view more information and the links to the Detective service to investigate it.</p><p><a href="/assets/img/posts/2022-06-18-amazon-guardduty-deep-dive/guardduty-investigate-detective.png" class="popup img-link border"><img data-src="/assets/img/posts/2022-06-18-amazon-guardduty-deep-dive/guardduty-investigate-detective.png" alt="guardduty-investigate-detective" class="lazyload" data-proofer-ignore></a></p><p><a href="https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_findings-summary.html?icmpid=docs_gd_help_panel" target="_blank">More information about finding details</a></p><h3 id="custom-responses-with-eventbridge"><span class="mr-2">Custom responses with EventBridge</span><a href="#custom-responses-with-eventbridge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>GuardDuty creates an event for EventBridge when any change in findings takes place (newly generated findings or newly aggregated findings).</p><p>By using EventBridge events with GuardDuty, you can automate tasks to help you respond to security issues revealed by GuardDuty findings.</p><p><a href="https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_findings_cloudwatch.html" target="_blank">More information</a></p><h3 id="subscribing-to-amazon-sns-guardduty-announcements"><span class="mr-2">Subscribing to Amazon SNS GuardDuty announcements</span><a href="#subscribing-to-amazon-sns-guardduty-announcements" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>An Amazon SNS topic is created by GuardDuty (you cannot view it from the SNS console) and you can subscribe to receive notifications about newly released finding types, updates to the existing finding types, and other functionality changes.</p><p><a href="https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_sns.html?icmpid=docs_console_unmapped" target="_blank">More information about how to do it</a></p><h3 id="remediating-security-issues"><span class="mr-2">Remediating security issues</span><a href="#remediating-security-issues" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>These are the recommended actions to remediate these scenarios.</p><h4 id="remediating-a-compromised-ec2-instance"><span class="mr-2">Remediating a compromised EC2 instance</span><a href="#remediating-a-compromised-ec2-instance" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>This is the information found in the official AWS documentation:</p><ol><li>Investigate the potentially compromised instance for malware and remove any discovered malware<li>If you are unable to identify and stop unauthorized activity on your EC2 instance, AWS recommends that you terminate the compromised EC2 instance and replace it with a new instance as needed</ol><p>However, I think that this is more appropriate to deal with compromised EC2 instances:</p><ol><li>Lock the instance down<li>Take the EBS snapshot<li>Perform a memory dump<li>Perform Forensic Analysis<li>Terminate the instance</ol><h4 id="remediating-a-compromised-s3-bucket"><span class="mr-2">Remediating a compromised S3 Bucket</span><a href="#remediating-a-compromised-s3-bucket" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li>Identify the affected S3 resource<li>Identify the source of the suspicious activity and the API call used<li>Determine whether the call source was authorized to access the identified resource. If the access was authorized, you can ignore the finding</ol><h4 id="remediating-compromised-aws-credentials"><span class="mr-2">Remediating compromised AWS credentials</span><a href="#remediating-compromised-aws-credentials" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li>Identify the affected IAM entity and the API call used<li>Review permissions for the IAM entity<li>Determine whether the IAM entity credentials were used legitimately. If you confirm that the activity is a legitimate use of the AWS credentials, you can ignore the GuardDuty finding</ol><h4 id="remediating-kubernetes-security-issues-discovered-by-guardduty"><span class="mr-2">Remediating Kubernetes security issues discovered by GuardDuty</span><a href="#remediating-kubernetes-security-issues-discovered-by-guardduty" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_remediate.html" target="_blank">More information</a></p><hr /><h2 id="good-to-know"><span class="mr-2">Good to know</span><a href="#good-to-know" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Regional service<li><strong>30 days free trial</strong> when you enable it the first time, and during the free trial GuardDuty provides an estimate of what the spend would be, so you can assess your spending beyond the free trial.<li>All findings are stored in GuardDuty for <strong>90 days</strong>. GuardDuty recommends setting up findings export, which allows you to export your findings to an S3 bucket for indefinite storage.<li>The events are delivered to EventBridge in near-real-time and on a best-effort basis.<li>Amazon GuardDuty consumes CloudTrail management and S3 data events directly from CloudTrail through an independent and duplicative stream of events (no additional cost)<li><strong>Global events</strong> in CloudTrail (IAM, AWS Security Token Service, Amazon S3, Amazon CloudFront, and Route 53) are delivered to any trail that includes global services and are <strong>logged as occurring in the US East (N. Virginia) Region</strong>.<li>When you enable GuardDuty, it immediately starts analyzing your VPC flow logs data. It consumes VPC flow log events directly from the VPC flow logs feature through an independent and duplicative stream of flow logs, so Flow logs for VPCs do not need to be turned on to generate findings.<li>All findings are dynamic, meaning that, if GuardDuty detects new activity related to the same security issue it will update the original finding with the new information, instead of generating a new finding<li>Finding types (4): EC2, IAM, S3 and Kubernetes. The official documentation has a full explanation about each category and each finding inside, you can find it <a href="https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_finding-types-active.html" target="_blank">here</a><li>GuardDuty lists allow you to customize the publicly routable IP addresses that GuardDuty generates findings for. You can create a <code class="language-plaintext highlighter-rouge">Trusted IP list</code> and a <code class="language-plaintext highlighter-rouge">Threat list</code>.</ul><hr /><h2 id="more-information-about-guardduty"><span class="mr-2">More information about GuardDuty</span><a href="#more-information-about-guardduty" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><a href="https://docs.aws.amazon.com/guardduty/latest/ug/what-is-guardduty.html">Official documentation</a><li><a href="https://hands-on-guardduty.awssecworkshops.com/">Amazon GuardDuty Workshop</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/security/'>Security</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/security/" class="post-tag no-text-decoration" >security</a> <a href="/tags/guardduty/" class="post-tag no-text-decoration" >guardduty</a> <a href="/tags/deep-dive/" class="post-tag no-text-decoration" >deep dive</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Amazon%20GuardDuty:%20Deep%20dive%20-%20Playing%20AWS&url=https%3A%2F%2Fwww.playingaws.com%2F%2Fposts%2Famazon-guardduty-deep-dive%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fwww.playingaws.com%2F%2Fposts%2Famazon-guardduty-deep-dive%2F&text=Amazon%20GuardDuty:%20Deep%20dive%20-%20Playing%20AWS" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fwww.playingaws.com%2F%2Fposts%2Famazon-guardduty-deep-dive%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading"></div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/aws-open-source-tools/">Getting started with AWS open-source tools</a><li><a href="/posts/getting-started-with-aws-security/">Getting Started with AWS Security</a><li><a href="/posts/how-to-improve-your-account-security/">How to improve your account security</a></ul></div><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/challenge-data-certification-in-30-days/">Challenge: 'AWS Certified Data Analytics Specialty' in 30 days</a><li><a href="/posts/10-steps-to-prepare-any-aws-certification/">10 steps to prepare any AWS certification</a><li><a href="/posts/aws-control-tower-deep-dive/">AWS Control Tower Deep Dive</a><li><a href="/posts/the-technology-behind-this-blog/">How I decided on the technology behind the blog</a><li><a href="/posts/multi-account-approach/">Getting started with AWS Multi-account approach</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/github/">github</a> <a class="post-tag" href="/tags/how-to/">how-to</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/iac/">iac</a> <a class="post-tag" href="/tags/getting-started/">getting-started</a> <a class="post-tag" href="/tags/cdk/">cdk</a> <a class="post-tag" href="/tags/deep-dive/">deep dive</a> <a class="post-tag" href="/tags/serverless/">serverless</a> <a class="post-tag" href="/tags/certification/">certification</a> <a class="post-tag" href="/tags/open-source/">open-source</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/aws-waf-web-application-firewall-deep-dive/"><div class="card-body"> <em class="small" data-ts="1684518060" data-df="ll" > May 19, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS WAF (Web Application Firewall): Deep Dive</h3><div class="text-muted small"><p> Introduction A Web Application Firewall (WAF) is a security solution that protects web applications from malicious attacks, such as cross-site scripting, SQL injection, and malicious bot traffic. ...</p></div></div></a></div><div class="card"> <a href="/posts/aws-security-hub-deep-dive/"><div class="card-body"> <em class="small" data-ts="1655500800" data-df="ll" > Jun 17, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS Security Hub: Deep dive</h3><div class="text-muted small"><p> Introduction AWS Security Hub is a cloud security posture management service that: Reduced effort to collect and prioritize findings performs automatic security checks against best practic...</p></div></div></a></div><div class="card"> <a href="/posts/aws-control-tower-deep-dive/"><div class="card-body"> <em class="small" data-ts="1665268200" data-df="ll" > Oct 9, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS Control Tower Deep Dive</h3><div class="text-muted small"><p> Introduction This is the second article of AWS Control Tower and the AWS multi-account approach. In the first article I had explained why you need a multi-account approach, what are the best ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/aws-security-hub-deep-dive/" class="btn btn-outline-primary" prompt="Older"><p>AWS Security Hub: Deep dive</p></a> <a href="/posts/multi-account-approach/" class="btn btn-outline-primary" prompt="Newer"><p>Getting started with AWS Multi-account approach</p></a></div><script type="text/javascript"> document.getElementsByClassName("post-content")[0].innerHTML += '<h2 id="comment-this-post">Comment this post</h2>'; document.getElementsByClassName("post-content")[0].innerHTML += '<p>I hope this content has been relevant to you. To help me improve it would be helpful if you could give me your honest feedback.</p>'; $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "alazaroc/blog-web", "data-repo-id": "R_kgDOHA-hqQ", "data-category": "Announcements", "data-category-id": "DIC_kwDOHA-hqc4CT2E5", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "top", "data-lang": "", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementsByClassName("post-content")[0].appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/github/">github</a> <a class="post-tag" href="/tags/how-to/">how-to</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/iac/">iac</a> <a class="post-tag" href="/tags/getting-started/">getting-started</a> <a class="post-tag" href="/tags/cdk/">cdk</a> <a class="post-tag" href="/tags/deep-dive/">deep dive</a> <a class="post-tag" href="/tags/serverless/">serverless</a> <a class="post-tag" href="/tags/certification/">certification</a> <a class="post-tag" href="/tags/open-source/">open-source</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://www.linkedin.com/in/alejandro-lazaro-chueca/">Alejandro Lazaro</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Deployed with AWS resources.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-HW1NDPDLBF"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-HW1NDPDLBF'); }); </script>
